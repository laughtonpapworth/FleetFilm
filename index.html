<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#1f2937"/>
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" href="icons/icon-192.png" />
  <link rel="icon" href="img/FFIcon.png" sizes="32x32" type="image/png">
  <title>Fleet Film</title>
  <link rel="stylesheet" href="css/styles.css">
  <!-- Firebase (compat) -->
  <script defer src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
  <script defer src="js/firebase-config.js"></script>
  <script defer src="js/app.js"></script>
</head>
<body>
  <!-- Start collapsed; JS will show/hide this whole nav by login state -->
<header class="header">
  <div class="brand">
    <img class="logo" src="img/FFLogo.png" alt="Fleet Film">
    <div class="title">Fleet Film</div>
  </div>

  <!-- collapsible nav; JS adds/removes .hidden and .nav--open -->
  <nav id="nav" class="nav hidden">
    <button id="nav-submit"    data-view="submit">Submit</button>
    <button id="nav-intake"    data-view="pending">Pending Films</button>
    <button id="nav-basic"     data-view="basic">Basic Criteria</button>
    <button id="nav-viewing"   data-view="viewing">Viewing</button>
    <button id="nav-vote"      data-view="vote">Voting</button>
    <button id="nav-uk"        data-view="uk">UK Distributor</button>
    <button id="nav-green"     data-view="green">Green List</button>
    <button id="nav-nextprog"  data-view="nextprog">Next Programme</button>
    <button id="nav-discarded" data-view="discarded">Discarded</button>
    <button id="nav-archive"   data-view="archive">Archive</button>
    <button id="nav-calendar"  data-view="calendar">Calendar</button>
    <button id="nav-addresses" data-view="addresses">Addresses</button>
  </nav>

  <div class="header-actions">
    <button id="nav-toggle" class="btn btn-ghost">Menu</button>
    <button id="btn-signout" class="btn btn-ghost">Sign out</button>
  </div>
</header>


<main class="container">
  <!-- Signed out -->
  <div id="signed-out" class="center">
    <div class="card signin-card" role="region" aria-label="Sign in">
      <h1>Welcome to Fleet Film</h1>
      <p style="font-size:18px; line-height:1.4;">
        Secure sign-in required. This site works on phones and can be installed like an app.
      </p>
      <div class="actions">
        <button id="btn-google" class="btn btn-primary big" aria-label="Sign in with Google">Sign in with Google</button>
      </div>
      <div class="hr"></div>
      <label for="email" class="large-label">Email</label>
      <input id="email" type="email" placeholder="you@example.com" autocomplete="username" />
      <label for="password" class="large-label">Password</label>
      <input id="password" type="password" placeholder="Password" autocomplete="current-password" />
      <div class="actions">
        <button id="btn-email-signin" class="btn btn-accent big" aria-label="Sign in with email">Sign in</button>
        <button id="btn-email-create" class="btn btn-ghost big" aria-label="Create account">Create account</button>
      </div>
      <div class="notice" role="status">
        Need help? Ask an admin to invite you. Big buttons, simple screens, large text.
      </div>
    </div>
  </div>

  <!-- Signed in -->
  <div id="signed-in" class="hidden">

    <!-- Pending Films -->
    <section id="view-intake" class="card" aria-label="Pending films">
      <h1>Pending Films</h1>
      <div class="toolbar" id="film-toolbar">
        <input id="filter-q" type="text" placeholder="Search title‚Ä¶">
        <select id="filter-status">
          <option value="">All stages</option>
          <option value="intake">Unprocessed</option>
        </select>
        <div class="spacer"></div>
        <button id="filter-clear" class="btn btn-ghost">Clear</button>
      </div>
      <div class="list" id="intake-list"></div>
    </section>

    <!-- Submit -->
    <section id="view-submit" class="card hidden" aria-label="Submit film">
      <h1>Submit</h1>
      <label>Film Title
        <input id="f-title" type="text" placeholder="e.g. The Godfather">
      </label>
      <label>Year
        <input id="f-year" type="number" placeholder="e.g. 1972">
      </label>
      <div class="actions">
        <button id="btn-submit-film" class="btn btn-primary big">Add Film</button>
      </div>
      <div id="submit-msg" class="notice hidden">Added.</div>
    </section>

    <!-- Basic Criteria -->
    <section id="view-basic" class="card hidden" aria-label="Basic criteria">
      <h1>Basic Criteria</h1>
      <div class="list" id="basic-list"></div>
    </section>

    <!-- Viewing -->
    <section id="view-viewing" class="card hidden" aria-label="Viewing queue">
      <h1>Viewing</h1>
      <div class="list" id="viewing-list"></div>
    </section>

    <!-- Voting -->
    <section id="view-vote" class="card hidden" aria-label="Voting">
      <h1>Voting</h1>
      <div class="list" id="vote-list"></div>
    </section>

    <!-- UK Distributor -->
    <section id="view-uk" class="card hidden" aria-label="UK Distributor check">
      <h1>UK Distributor</h1>
      <div class="list" id="uk-list"></div>
    </section>

    <!-- Green List -->
    <section id="view-green" class="card hidden" aria-label="Green list">
      <h1>Green List</h1>
      <div class="list" id="green-list"></div>
    </section>

    <!-- Next Programme -->
    <section id="view-nextprog" class="card hidden" aria-label="Next Programme">
      <h1>Next Programme</h1>
      <div class="list" id="nextprog-list"></div>
    </section>

    <!-- Discarded -->
    <section id="view-discarded" class="card hidden" aria-label="Discarded">
      <h1>Discarded</h1>
      <div class="list" id="discarded-list"></div>
    </section>

    <!-- Archive -->
    <section id="view-archive" class="card hidden" aria-label="Archive">
      <h1>Archive</h1>
      <div class="list" id="archive-list"></div>
    </section>

    <!-- Addresses (admin) -->
    <section id="view-addresses" class="card hidden" aria-label="Saved addresses">
      <h1>Saved Addresses</h1>
      <div id="addresses-admin-msg" class="notice hidden"></div>
      <div class="actions" style="margin-bottom:8px">
        <button id="addr-refresh" class="btn">Refresh</button>
      </div>
      <div class="table-wrap">
        <table class="table" id="addresses-table">
          <thead>
            <tr>
              <th style="width:22%">Name</th>
              <th style="width:30%">Address</th>
              <th style="width:18%">City</th>
              <th style="width:14%">Postcode</th>
              <th style="width:16%">Actions</th>
            </tr>
          </thead>
          <tbody><!-- filled by JS --></tbody>
        </table>
      </div>
    </section>

    <!-- Calendar -->
    <section id="view-calendar" class="card hidden" aria-label="Calendar">
      <h1>Calendar</h1>
      <div class="list" id="calendar-list"></div>

      <!-- Editor pane (prefilled from calendar or Viewing) -->
      <div class="card" style="padding:14px; margin-top:10px" id="calendar-card">
        <div class="cal-head">
          <button class="btn btn-ghost" id="cal-back" aria-label="Back">‚óÄ Back</button>
          <div class="cal-title" id="cal-title">Month YYYY</div>
          <div>
            <button class="btn btn-ghost" id="cal-prev" aria-label="Previous month">‚óÄ</button>
            <button class="btn btn-ghost" id="cal-next" aria-label="Next month">‚ñ∂</button>
          </div>
        </div>
        <div class="cal-grid" id="cal-grid"></div>
        <div class="hr"></div>
        <div class="form-grid" id="cal-editor" style="align-items:end">
          <label>Date<input id="cal-date" type="date"></label>
          <label>Time (optional)<input id="cal-time" type="time"></label>
          <label>Location
            <select id="cal-loc-select"></select>
          </label>
          <div class="actions">
            <button class="btn" id="cal-add-loc">+ Add new location</button>
          </div>
          <div class="actions span-2">
            <button class="btn btn-primary" id="cal-save">Save schedule</button>
            <button class="btn btn-danger" id="cal-clear">Remove from calendar</button>
          </div>
        </div>
      </div>
    </section>

  </div>
</main>

<footer>
  Tip: On your phone, use ‚ÄúAdd to Home Screen‚Äù to install.
</footer>

<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('sw.js').catch(console.error);
    });
  }
</script>

<!-- Mobile bottom tab bar (JS hides it when signed out) -->
<!-- Mobile bottom tab bar (shown only when signed in) -->
<nav id="mobile-tabbar" class="mobile-tabbar hidden">
  <button data-view="submit"><span class="ico">‚ûï</span><span>Submit</span></button>
  <button data-view="viewing"><span class="ico">üé¨</span><span>Viewing</span></button>
  <button data-view="vote"><span class="ico">üó≥Ô∏è</span><span>Voting</span></button>
  <button data-view="calendar"><span class="ico">üóìÔ∏è</span><span>Calendar</span></button>
  <button id="tab-more"><span class="ico">‚ãØ</span><span>More</span></button>
</nav>



<div id="modal-root"></div>
</body>
</html>
